
<% if defined?(@description) -%>
#
# <%= @description %>
#

<% end -%>
Match <%= -%>
<%- if defined?(@groups) -%> group <%= @groups.join(',') %> <% end -%>
<%- if defined?(@users) -%> user <%= @users.join(',') %> <% end -%>
<%- if defined?(@hosts) -%> host <%= @hosts.join(',') %> <% end -%>
<%- if defined?(@addresses) -%> address <%= @addresses.join(',') %> <% end %>
  <%- if defined?(@chrootdirectory) -%>
  ChrootDirectory <%= @chrootdirectory %>
  <%- end -%>
  <%- if defined?(@password_authentication) -%>
  PasswordAuthentication <%= scope.function_bool2yesno([@password_authentication]) %>
  PubkeyAuthentication <%= scope.function_bool2yesno([@pubkey_authentication_match]) %>
  <%- end -%>
  <%- if defined?(@forcecommand) -%>
  ForceCommand <%= @forcecommand %>
  <%- end -%>
  <%- if defined?(@banner) -%>
  Banner <%= @banner %>
  <%- end -%>
  <%- if defined?(@allow_tcp_forwarding) -%>
  AllowTcpForwarding <%= scope.function_bool2yesno([@allow_tcp_forwarding]) %>
  <%- end -%>
  <%- if defined?(@allowed_ips) -%>
  <%- @users.each do |username| -%>
  <%- @allowed_ips.each do |ip| -%>
  AllowUsers <%= username %>@<%= ip %>
  <%- end -%>
  <%- end -%>
  <%- end -%>
